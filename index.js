(function () {function f(e,r,a,n,t,i,o){try{var s=e[i](o),c=s.value}catch(u){return void a(u)}s.done?r(c):Promise.resolve(c).then(n,t)}function j(e){return function(){var r=this,a=arguments;return new Promise(function(n,t){var i=e.apply(r,a);function o(e){f(i,n,t,o,s,"next",e)}function s(e){f(i,n,t,o,s,"throw",e)}o(void 0)})}}var k={methods:{thumb:function(t){if(!t||0===t.length)return!1;var r=null,e=null;return t.list?(r=t.list.url,e=t.list.srcset):(r=t.url,e=t.srcset),!!r&&{src:r,srcset:e,back:t.back||"black",cover:t.cover}}}};var b={extends:"k-search",mixins:[k],methods:{search:function(r){var a=this;return j(regeneratorRuntime.mark(function n(){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a.$api.get("search",{q:r,select:["id","title","email","name","filename","link","avatar","panelIcon","panelImage"]});case 3:t=n.sent,a.items=t.data.map(function(e){var r;return e.hasOwnProperty("email")?((r=a.map_users(e)).icon={type:"user"},r.image=e.avatar?e.avatar:null):e.hasOwnProperty("filename")?((r=a.map_files(e)).icon=e.panelIcon,r.image=e.panelImage):(r=a.map_pages(e)).icon=e.panelIcon,r}),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(e),a.items=[];case 11:return n.prev=11,a.selected=-1,n.finish(11);case 14:case"end":return n.stop();}},n,null,[[0,7,11,14]])}))()}}};if(typeof b==="function"){b=b.options}Object.assign(b,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("div",{staticClass:"k-search",attrs:{"role":"search"},on:{"click":_vm.close}},[_c("div",{staticClass:"k-search-box",on:{"click":function($event){$event.stopPropagation()}}},[_c("div",{staticClass:"k-search-input"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.q,expression:"q"}],ref:"input",attrs:{"placeholder":_vm.$t("search")+" \u2026","aria-label":_vm.$t("search"),"type":"text"},domProps:{"value":_vm.q},on:{"keydown":[function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"down",40,$event.key,["Down","ArrowDown"])){return null}$event.preventDefault();return _vm.down($event)},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"up",38,$event.key,["Up","ArrowUp"])){return null}$event.preventDefault();return _vm.up($event)},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"tab",9,$event.key,"Tab")){return null}$event.preventDefault();return _vm.tab($event)},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){return null}return _vm.enter($event)},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"])){return null}return _vm.close($event)}],"input":function($event){if($event.target.composing){return}_vm.q=$event.target.value}}}),_vm._v(" "),_c("k-button",{staticClass:"k-search-close",attrs:{"tooltip":_vm.$t("close"),"icon":"cancel"},on:{"click":_vm.close}})],1),_vm._v(" "),_c("ul",_vm._l(_vm.items.slice(0,10),function(item,itemIndex){return _c("li",{key:item.id,attrs:{"data-selected":_vm.selected===itemIndex},on:{"mouseover":function($event){_vm.selected=itemIndex}}},[_c("k-link",{attrs:{"to":item.link},on:{"click":_vm.close}},[_vm.thumb(item.image)?_c("k-image",_vm._b({},"k-image",_vm.thumb(item.image),false)):_c("k-icon",_vm._b({},"k-icon",item.icon,false)),_vm._v(" "),_c("div",[_c("strong",[_vm._v(_vm._s(item.title))]),_vm._v(" "),_c("small",[_vm._v(_vm._s(item.info))])])],1)],1)}),0)])])};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());function g(e,r,t,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void t(u)}c.done?r(s):Promise.resolve(s).then(n,a)}function h(e){return function(){var r=this,t=arguments;return new Promise(function(n,a){var o=e.apply(r,t);function i(e){g(o,n,a,i,c,"next",e)}function c(e){g(o,n,a,i,c,"throw",e)}i(void 0)})}}var d={data:function(){return{headline:""}},created:function(){var e=this;return h(regeneratorRuntime.mark(function r(){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.load();case 2:t=r.sent,e.headline=t.headline;case 4:case"end":return r.stop();}},r)}))()},methods:{build:function(){var r=this;return h(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.$api.post("search");case 3:r.$store.dispatch("notification/success",r.$t("search.built")),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(e);case 9:case"end":return t.stop();}},t,null,[[0,6]])}))()}}};if(typeof d==="function"){d=d.options}Object.assign(d,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"k-section-header"},[_c("k-headline",[_vm._v(_vm._s(_vm.headline))])],1),_vm._v(" "),_c("k-button",{attrs:{"icon":"refresh"},on:{"click":_vm.build}},[_vm._v(" "+_vm._s(_vm.$t("search.build"))+" ")])],1)};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());panel.plugin("distantnative/search-for-kirby",{sections:{search:d},components:{"k-search":b}});})();